{% extends 'layout.html' %}

{% block content %}
<div id="loading-overlay" class="loading-overlay">
    <div class="spinner-container">
        <div class="spinner"></div>
        <p class="loading-text">Generating your Spotify insights...</p>
    </div>
</div>

<h1 class="mb-4">Your Listening Dashboard</h1>

<div class="row">
    <div class="col-md-3">
        <div class="card mb-4">
            <div class="card-body text-center">
                <h5 class="card-title">Total Records</h5>
                <p class="display-4">{{ records_count }}</p>
                <p class="text-muted">Listening events analyzed</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card mb-4">
            <div class="card-body text-center">
                <h5 class="card-title">Listening Time</h5>
                <p class="display-4">{{ total_hours|round(1) }}</p>
                <p class="text-muted">Hours of music & podcasts</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card mb-4">
            <div class="card-body text-center">
                <h5 class="card-title">Unique Tracks</h5>
                <p class="display-4">{{ unique_tracks }}</p>
                <p class="text-muted">Different songs played</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card mb-4">
            <div class="card-body text-center">
                <h5 class="card-title">Unique Artists</h5>
                <p class="display-4">{{ unique_artists }}</p>
                <p class="text-muted">Different artists played</p>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Listening Activity Heatmap</h5>
            </div>
            <div class="card-body">
                <img src="{{ url_for('static', filename='images/heatmap.png') }}" class="img-fluid" alt="Listening Heatmap">
                <p class="text-muted mt-2">This heatmap shows when you listen to music the most throughout the week.</p>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Top Artists</h5>
            </div>
            <div class="card-body">
                <img src="{{ url_for('static', filename='images/top_artists.png') }}" class="img-fluid" alt="Top Artists">
                <p class="text-muted mt-2">Your most played artists based on play count.</p>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Monthly Listening Trend</h5>
            </div>
            <div class="card-body">
                <img src="{{ url_for('static', filename='images/monthly_trend.png') }}" class="img-fluid" alt="Monthly Trend">
                <p class="text-muted mt-2">How your listening habits have changed over time.</p>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Listening Duration Distribution</h5>
            </div>
            <div class="card-body">
                <img src="{{ url_for('static', filename='images/duration_histogram.png') }}" class="img-fluid" alt="Duration Histogram">
                <p class="text-muted mt-2">Distribution of how long you typically listen to tracks.</p>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Skip Rate by Hour</h5>
            </div>
            <div class="card-body">
                <img src="{{ url_for('static', filename='images/skip_rate_hour.png') }}" class="img-fluid" alt="Skip Rate by Hour">
                <p class="text-muted mt-2">When you're most likely to skip tracks throughout the day.</p>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Content Type Distribution</h5>
            </div>
            <div class="card-body">
                <img src="{{ url_for('static', filename='images/content_pie.png') }}" class="img-fluid" alt="Content Type Distribution">
                <p class="text-muted mt-2">Breakdown of music, podcasts, and other content you listen to.</p>
            </div>
        </div>
    </div>
</div>

<div class="text-center mt-4 mb-5">
    <a href="{{ url_for('artists') }}" class="btn btn-primary mr-2">
        <i class="fas fa-user-friends mr-1"></i> Explore Artists
    </a>
    <a href="{{ url_for('tracks') }}" class="btn btn-primary mr-2">
        <i class="fas fa-music mr-1"></i> Explore Tracks
    </a>
    <a href="{{ url_for('advanced') }}" class="btn btn-primary mr-2">
        <i class="fas fa-chart-line mr-1"></i> Advanced Analytics
    </a>
    <a href="{{ url_for('export_data') }}" class="btn btn-success">
        <i class="fas fa-file-export mr-1"></i> Export Data
    </a>
</div>

<script>
    // Hide loading overlay when all images are loaded
    window.addEventListener('load', function() {
        const loadingOverlay = document.getElementById('loading-overlay');
        loadingOverlay.style.opacity = '0';
        setTimeout(function() {
            loadingOverlay.style.display = 'none';
        }, 500);
    });
</script>
{% endblock %}
